glue_dnaSeqQC_all
glue_dnaSeqQC_create_tmp_dir
    Create temporary directory for use by pipeline
glue_dnaSeqQC_download_reference
    
    Download white clover reference genome from NCBI's FTP directory
    
glue_dnaSeqQC_unzip_reference
    
    Unzip reference genome
    
glue_dnaSeqQC_samtools_index_reference
    
    Index reference genome with samtools
    
glue_dnaSeqQC_bwa_index_ref
    
    Index reference with bwa to get ready for read mapping
    
glue_dnaSeqQC_ref_done
    
    Writes empty flag file to signal successful completion of reference genome rules.
    
glue_dnaSeqQC_fastp_trim
    
    Trims Illumina adapters from raw reads using fastp. Also trims
    poly-G tails generated by Novaseq S4 platform. Generates HTML and
    JSON files with QC info from trimming.
    
glue_dnaSeqQC_bwa_map_unpaired
    
    Map trimmed unpaired reads to the reference genome using bwa mem. Output as BAM
    
glue_dnaSeqQC_bwa_map_paired
    
    Map trimmed paired reads to the reference genome using bwa mem. Output as BAM
    
glue_dnaSeqQC_merge_bams
    
    Merge unpaired and paired read mapping BAM files
    
glue_dnaSeqQC_samtools_markdup
    
    Mark duplicate reads using samtools. Output sorted BAM.
    
glue_dnaSeqQC_index_bam
    
    Index sorted BAM with marked duplicates
    
glue_dnaSeqQC_fastqc_raw_reads
    
    QC of raw reads using FASTQC. Simplifies output filenames for easier pipeline integration
    
glue_dnaSeqQC_fastqc_trimmed_reads
    
    QC of trimmed reads using FASTQC.
    
glue_dnaSeqQC_qualimap_bam_qc
    
    QC mapped reads using Qualimap
    
glue_dnaSeqQC_bamtools_stats
    
    Basic stats for mapped reads (e.g., % aligned, duplicates, etc.). Similar to samtools stats.
    
glue_dnaSeqQC_bamutil_validate
    
    Validate BAM files to flag any obvious errors (e.g., truncation, header issues, etc.)
    
glue_dnaSeqQC_multiqc
    
    Generate single HTML report with all QC info for all samples using multiQC.
    Inputs only enforce dependencies. MultiQC takes results folder as input (i.e., QC_DIR)
    
glue_dnaSeqQC_downsample_toronto_bam
    
    Sample 25% of reads from Toronto sample using samtools. 
    
glue_dnaSeqQC_index_toronto_bam
    
    Index downsampled Toronto BAM using samtools. Required for variant calling using ANGSD.
    
glue_dnaSeqQC_downsample_toronto_done
    
    Generate empty flag file signalling successful completion of Toronto BAM downsampling.
    
all
create_tmp_dir
    Create temporary directory for use by pipeline
clone_degeneracy
    
    Clone Degeneracy GitHub repo for getting 4fold and 0fold sites.
    
get_fourfold_zerofold
    
    Uses get_4fold_sites.sh from Degeneracy to get 4fold and 0fold sites across white clover
    genome from reference sequence (FASTA) and annotation file (GFF).
    
degeneracy_done
    
    Write empty flag file signalling successful completion of Degenerate site extraction
    
subset_bams_degeneracy
    
    Subset BAMs for all samples around 4fold sites to speed up ANGSD computations.
    
index_degenerate_bam
    
    Index BAM subsetted around 4fold sites
    
create_samples_to_remove
    
    Writes file with sample names for those with high alignment error rates.
    Thresholds were assessed through exploratory analysis of QC data. 
    
create_bam_list_finalSamples
    
    Create text file with paths to BAMs, excluding samples with high alignment error rates
    
convert_sites_for_angsd
    
    Converts 0-based BED files for 0fold and 4fold sites output from Degeneracy to 1-based 
    site coordinates required by ANGSD
    
angsd_index_allDegenerateSites
    
    Indexes ANGSD sites files containing all genome-wide 4fold or 0fold sites.
    
select_random_degenerate_sites
    
    Randomly select `params.nSites` degenerate (i.e., 4fold or 0fold) sites from across the genome
    
angsd_index_random_degen_sites
    
    Index randomly selected genome-wide degenerate sites for use with ANGSD
    
split_random_angsd_sites_byChrom
    
    Split randomly selected degenerate ANGSD sites file into separate sites files by chromosome. Helps parallelize some computations.
    
index_random_chromosomal_angsd_sites
    
    Index chromosomal ANGSD sites files for use with ANGSD
    
angsd_gl_allSamples
    
    Estimate genotype likelihoods for all samples separately for each of 16 chromosomes using ANGSD.
    
concat_angsd_gl
    
    Concatenated GLs from all 16 chromosomes into single file. Done separately for each site type.
    
concat_angsd_mafs
    
    Concatenate MAF files for each of 16 chromosomes into single file. Done separately for each site type.
    
angsd_allSamples_done
    
    Generate empty flag file signalling successful completion of GL estimation across all samples. 
    
create_bam_list_byCity_byHabitat
    
    Create text file with paths to BAM files in each habitat by city. 
    
angsd_saf_likelihood_byCity_byHabitat
    
    Generate Site Allele Frequency (SAF) likelihood file for each habitat in each city using ANGSD. 
    Uses only 4fold sites.
    
angsd_estimate_joint_sfs_byCity
    
    Estimated folded, two-dimensional urban-rural SFS for each city using realSFS. Uses 4fold sites.
    
angsd_estimate_sfs_byCity_byHabitat
    
    Estimate folded SFS separately for each habitat in each city (i.e., 1D SFS) using realSFS. 
    
angsd_fst_index
    
    Estimate per-site alphas (numerator) and betas (denominator) for Fst estimation.
    
angsd_fst_readable
    
    Create readable Fst files. Required due to format of realSFS fst index output files. 
    
angsd_estimate_thetas_byCity_byHabitat
    
    Generate per-site thetas in each habitat for each city from 1DSFS
    
angsd_diversity_neutrality_stats_byCity_byHabitat
    
    Estimate pi, Waterson's theta, Tajima's D, etc. in each habitat in each city.
    
angsd_byCity_byHabitat_done
    
    Generate empty flag file signalling successful completion of SFS, summary stat and GL estimation 
    for habitats within cities
    
create_random_bam_list_byCity_byHabitat
    
    Create text files with paths to BAM files for each city. 'urban' and 'rural' samples are randomly
    selected from all possible bams for a city. Sample sizes are the same as those in the observed samples.
    
angsd_permuted_saf_likelihood_byCity_byHabitat
    
    Generate Site Allele Frequency (SAF) likelihood file for each habitat in each city using ANGSD. 
    Uses only 4fold sites. Uses permuted urban and rural samples 
    
angsd_estimate_permuted_joint_sfs_byCity
    
    Estimated folded, two-dimensional urban-rural SFS for each city using realSFS. Uses 4fold sites.
    Uses permuted urban and rural samples.
    
angsd_estimate_permuted_sfs_byCity_byHabitat
    
    Estimate folded SFS separately for each habitat in each city (i.e., 1D SFS) using realSFS. Uses permuted 
    urban and rural samples.
    
angsd_permuted_fst_index
    
    Estimate per-site alphas (numerator) and betas (denominator) for Hudson's Fst estimator.
    Uses permuted urban and rural samples.
    
angsd_permuted_fst_readable
    
    Create readable Fst files. Required due to format of realSFS fst index output files. Uses permuted 
    urban and rural samples.
    
angsd_estimate_permuted_thetas_byCity_byHabitat
    
    Generate per-site thetas in each habitat for each city from 1DSFS. Uses permuted urban and rural samples.
    
angsd_permuted_diversity_neutrality_stats_byCity_byHabitat
    
    Estimate pi, Waterson's theta, Tajima's D, etc. in each habitat in each city. Uses permuted urban and rural samples
    
angsd_byCity_byHabitat_permuted_done
    
    Generate empty flag file signalling successful completion of pairwise pi and Fst analysis
    
concat_habitat_bamLists_withinCities
    
    Concatenate urban and rural sample BAM lists within cities. Generates a single file with
    the paths to all of the BAM files for samples within a city
    
remove_lowCovSamples_forPCA_byCity
    
    Removes samples with mean coverage lower than `params.cov` from within-city BAM lists.
    
angsd_gl_byCity
    
    Estimate Beagle genotype likelihoods jointly for all samples within city.
    
angsd_byCity_done
pcangsd_allSamples
    
    Perform PCA using genome-wide 4fold dengenerate sites using all samples from all cities.
    
pcangsd_byCity
    
    Perform PCA by city using genome-wide 4fold dengenerate sites and estimate admixture proportions
    
pop_structure_done
    
    Generate empty flag file signaling successful completion of PCAngsd
    
split_angsd_sites_byChrom
    
    Split ANGSD sites file into separate sites files by chromosome
    
index_chromosomal_angsd_sites
    
    Index chromosomal ANGSD sites files for use with ANGSD
    
read_count_data
    
    Calculate number of reads overlapping target region in Ac or Li locus for each sample
    
calculate_hcn_loci_frequencies
    
    Estimate per-sample genotype likelihoods and per-city deletion frequencies from read counts
    at Ac or Li locus. Writes two dataframes to disk per locus.
    
angsd_saf_likelihood_snps_hcn_chroms
    
    Estimate Site Allele Frequency Likelihood (SAF) by city and habitat for SNPs along same chromosomes
    as Ac and Li loci
    
angsd_estimate_joint_sfs_snps_hcn_chroms
    
    Estimated folded, two-dimensional urban-rural SFS for each city using SNPs along HCN chroms.
    
angsd_fst_index_snps_hcn_chroms
    
    Estimate per-site alphas (numerator) and betas (denominator) for Fst estimation. Done separately using 
    both Weir and Cockeram and Hudson's Fst
    
angsd_fst_readable_snps_hcn_chroms
    
    Create readable Fst files. Required due to format of realSFS fst index output files. 
    
angsd_alleleFreqs_byCity
    
    Estimate minor allele frequency of 4fold SNPs across all samples in a city.
    Used to get polymophic SNPs across all samples in a city.
    
snps_forAlleleFreqs_byCity_byHabitat
    
    Extract positions of 4fold SNPs across all samples in a city
    
angsd_index_city_snps
    
    Index within-city 4fold SNP positions for use with ANGSD.
    
angsd_alleleFreqs_byCity_byHabitat
    
    Estimate frequency of 4fold SNPs separately in urban and rural habits for each city.
    Uses city-wide 4fold SNPs as -sites input to include SNPs that are fixed in one habitat or the other.
    
hcn_loci_freq_done
    
    Generate empty flag file to signal successful completion of HCN and Ac/Li differentiation test rules.
    
